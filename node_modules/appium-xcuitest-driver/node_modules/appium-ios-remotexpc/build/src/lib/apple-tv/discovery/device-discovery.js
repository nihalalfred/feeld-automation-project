import { logger } from '@appium/support';
import { BonjourDiscovery, } from '../../bonjour/bonjour-discovery.js';
import { PairingError } from '../errors.js';
/** Discovers Apple TV devices on the local network using Bonjour */
export class DeviceDiscoveryService {
    config;
    log = logger.getLogger('DeviceDiscoveryService');
    constructor(config) {
        this.config = config;
    }
    async discoverDevices() {
        try {
            const discovery = new BonjourDiscovery();
            this.log.info(`Discovering Apple TV devices (waiting ${this.config.discoveryTimeout / 1000} seconds)...`);
            return await discovery.discoverAppleTVDevicesWithIP(this.config.discoveryTimeout);
        }
        catch (error) {
            this.log.error('Device discovery failed:', error);
            throw new PairingError('Device discovery failed', 'DISCOVERY_ERROR', error);
        }
    }
}
