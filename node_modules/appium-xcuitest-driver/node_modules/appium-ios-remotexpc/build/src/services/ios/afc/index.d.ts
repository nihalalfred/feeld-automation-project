import { Readable, Writable } from 'node:stream';
import { AFC_FOPEN_TEXTUAL_MODES } from './constants.js';
import { AfcFileMode } from './enums.js';
export interface StatInfo {
    st_ifmt: AfcFileMode;
    st_size: bigint;
    st_blocks: number;
    st_mtime: Date;
    st_birthtime: Date;
    st_nlink: number;
    LinkTarget?: string;
    [k: string]: any;
}
/**
 * AFC client over RSD (Remote XPC shim).
 * After RSDCheckin, speaks raw AFC protocol on the same socket.
 */
export declare class AfcService {
    private readonly address;
    static readonly RSD_SERVICE_NAME = "com.apple.afc.shim.remote";
    private socket;
    private packetNum;
    private silent;
    constructor(address: [string, number], silent?: boolean);
    /**
     * List directory entries. Returned entries do not include '.' and '..'
     */
    listdir(dirPath: string): Promise<string[]>;
    stat(filePath: string): Promise<StatInfo>;
    isdir(filePath: string): Promise<boolean>;
    exists(filePath: string): Promise<boolean>;
    fopen(filePath: string, mode?: keyof typeof AFC_FOPEN_TEXTUAL_MODES): Promise<bigint>;
    fclose(handle: bigint): Promise<void>;
    createReadStream(handle: bigint, size: bigint): Readable;
    createWriteStream(handle: bigint, chunkSize?: number): Writable;
    fread(handle: bigint, size: bigint): Promise<Buffer>;
    fwrite(handle: bigint, data: Buffer, chunkSize?: number): Promise<void>;
    getFileContents(filePath: string): Promise<Buffer>;
    setFileContents(filePath: string, data: Buffer): Promise<void>;
    readToStream(filePath: string): Promise<Readable>;
    writeFromStream(filePath: string, stream: Readable): Promise<void>;
    pull(remoteSrc: string, localDst: string): Promise<void>;
    rmSingle(filePath: string, force?: boolean): Promise<boolean>;
    rm(filePath: string, force?: boolean): Promise<string[]>;
    rename(src: string, dst: string): Promise<void>;
    push(localSrc: string, remoteDst: string): Promise<void>;
    walk(root: string): Promise<Array<{
        dir: string;
        dirs: string[];
        files: string[];
    }>>;
    /**
     * Close the underlying socket
     */
    close(): void;
    /**
     * Connect to RSD port and perform RSDCheckin.
     * Keeps the underlying socket for raw AFC I/O.
     */
    private _connect;
    private _resolvePath;
    private _dispatch;
    private _receive;
    /**
     * Send a single-operation request and parse result.
     * Throws if status != SUCCESS.
     * Returns response DATA buffer when applicable.
     */
    private _doOperation;
}
export default AfcService;
//# sourceMappingURL=index.d.ts.map